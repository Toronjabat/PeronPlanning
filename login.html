<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Login PokerPlanning</title>
</head>
<body style="text-align:center; margin-top:50px;">
  <h1>Login</h1>
  <input type="text" id="username" placeholder="Usuario">
  <button id="loginBtn">Ingresar</button>
  <div id="message" style="margin-top:10px;color:red;"></div>

  <script>
    document.getElementById("loginBtn").addEventListener("click", async () => {
      const username = document.getElementById("username").value.trim();
      const messageDiv = document.getElementById("message");

      if (!username) {
        messageDiv.textContent = "Ingrese un usuario válido";
        return;
      }

      try {
        const res = await fetch("/login", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ username })
        });
        const data = await res.json();
        if (data.success) {
          localStorage.setItem("username", data.username);
          window.location.href = "PeronPlanning.html"; // página del juego
        } else {
          messageDiv.textContent = data.message || "Error en login";
        }
      } catch (err) {
        messageDiv.textContent = "Error de conexión al servidor";
      }
    });

    // Si ya hay usuario guardado, ir directo al juego
    if (localStorage.getItem("username")) {
      window.location.href = "PeronPlanning.html";
    }
  </script>
</body>
</html>
